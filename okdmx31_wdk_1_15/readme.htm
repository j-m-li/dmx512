<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 10 (filtered)">
<title>O’ksi’D DMX 512 3/1 interface Windows® Developement Kit</title>

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
h1
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:Arial;}
h2
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
h3
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:Arial;}
p.MsoList2, li.MsoList2, div.MsoList2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:28.3pt;
	margin-bottom:.0001pt;
	text-indent:-14.15pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:14.15pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.lattention, li.lattention, div.lattention
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman";}
@page Section1
	{size:595.3pt 841.9pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.Section1
	{page:Section1;}
-->
</style>

</head>

<body lang=FR link=blue vlink=purple>

<div class=Section1>

<p class=MsoNormal align=center style='text-align:center'><b><span lang=FR-CH
style='font-size:18.0pt;font-family:Arial'>O’ksi’D DMX 512 3/1 interface
Windows® Developement Kit</span></b></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=FR-CH
style='font-family:Arial'>Copyright © O'ksi'D 2003,2005</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=FR-CH
style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>The kit contains
a DLL with embedded auto-installable driver for Windows® NT, XP.</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>The DLL works under
Windows® 95/98 too.</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>All the source
codes are included in the kit and are redistributable under the terms of the
BSD license. (see the top of each source files for details).</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>The DLL must be installed
in the same directory as the final executable or in the
&lt;WINDOWS&gt;\system32 directory.</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-size:18.0pt;font-family:Arial'>C/C++
kit</span><span lang=FR-CH style='font-family:Arial'>&nbsp;:</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Files&nbsp;:</span></b></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Visual_C++_sample\okdmx31.h</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<i>Header with function definitions</i></span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Visual_C++_sample\okdmx31.dll</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<i>Redistributable dynamic library </i></span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Visual_C++_sample\okdmx31.lib</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<i>Library interface definition</i></span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Usage&nbsp;:</span></b></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>You must include the
okdmx31.h file in your C/C++ source.</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>In your project setting,
add okdm31.lib to the link/library modules options.</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>Then you can use the
two function Okdmx31Write() and Okdmx31Read() in your code.</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Int Okdmx31Write(
unsigned int Port, unsigned char Universe, unsigned char *Buffer)&nbsp;;</span></b></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Port</span></b><span
lang=FR-CH style='font-family:Arial'>&nbsp;: the physical adresse of the DMX
interface’s parallel port ( generally, 0x378 or 0x278). You must take care that
this is the address of a real parrallel port, or you may crash the computer. </span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Universe</span></b><span
lang=FR-CH style='font-family:Arial'>&nbsp;: the connector number of the DMX universe
(valid values are 0, 1 and 2)</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Buffer</span></b><span
lang=FR-CH style='font-family:Arial'>&nbsp;: a pointer to an array of <u>at
least</u> 512 bytes to be written on the DMX512 universe .</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>RETURN
VALUE&nbsp;:</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>0 if success. -1 if failed. If the function fails it is
recommended that you don’t use the Port until the users has reseted the device.</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>I<b>nt Okdmx31Read(
unsigned int port, unsigned char universe, unsigned char *buffer)&nbsp;;</b></span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Port</span></b><span
lang=FR-CH style='font-family:Arial'>&nbsp;: the physical adresse of the DMX
interface’s parallel port ( generally, 0x378 or 0x278). You must take care that
this is the address of a real parallel port, or you may crash the computer.</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Universe</span></b><span
lang=FR-CH style='font-family:Arial'>&nbsp;: the connector number of the DMX universe
(valid value is 0)</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Buffer</span></b><span
lang=FR-CH style='font-family:Arial'>&nbsp;: a pointer to an array of <u>at
least</u> 512 bytes to be read from the DMX512 universe .</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>RETURN
VALUE&nbsp;:</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>0 if success. -1 if failed. If the function fails it is
recommended that you don’t use the Port until the users has reseted the device.</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Example</span></b><span
lang=FR-CH style='font-family:Arial'>&nbsp;:</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>#include &quot;okdmx31.h&quot;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>Unsigned char in_buf[512], out_buf[512]&nbsp;;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>If (Okdmx31Read(0x378, 0, in_buf)&nbsp;) return
ERROR;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>If (Okdmx31Write(0x378, 0, out_buf)&nbsp;) return
ERROR&nbsp;;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-size:18.0pt;font-family:Arial'>Visual
Basic&nbsp;kit:</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Files</span></b><span
lang=FR-CH style='font-family:Arial'>:</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>Visual_Basic_sample\okdmx31.dll</span></p>

<p class=MsoNormal style='margin-left:70.8pt'><i><span lang=FR-CH
style='font-family:Arial'>Redistributable dynamic library </span></i></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>Visual_Basic_sample\okdmx31.bas</span></p>

<p class=MsoNormal style='margin-left:70.8pt'><i><span lang=FR-CH
style='font-family:Arial'>Library interface definition</span></i></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Public Declare
Function Okdmx31Read Lib &quot;okdmx31.dll&quot; _</span></b></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>(ByVal PortAddress
As Integer, ByVal Universe As Byte, Buffer As Byte) As Integer</span></b></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Public Declare
Function Okdmx31Write Lib &quot;okdmx31.dll&quot; _</span></b></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>(ByVal PortAddress
As Integer, ByVal Universe As Byte, Buffer As Byte) As Integer</span></b></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>Same usage as the
C++ functions. Buffer argument must be the first element of a 512 Byte array.</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Example</span></b><span
lang=FR-CH style='font-family:Arial'>&nbsp;:</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>Public Declare Function Okdmx31Read Lib
&quot;okdmx31.dll&quot; _</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>(ByVal PortAddress As Integer, ByVal Universe As Byte,
Buffer As Byte) As Integer</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>Public Declare Function Okdmx31Write Lib
&quot;okdmx31.dll&quot; _</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>(ByVal PortAddress As Integer, ByVal Universe As
Byte, Buffer As Byte) As Integer</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>Dim InBuf(511) As Byte</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>Dim OutBuf(511) As Byte</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>If Okdmx31Read(Val(&quot;&amp;H378&quot;), 0, Inbuf(0))
&lt;&gt; 0 Then</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ERROR</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>End If</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>If Okdmx31Write(Val(&quot;&amp;H378&quot;), 0, Outbuf(0))
&lt;&gt; 0 Then</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ERROR</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>End If</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Universal function
:</span></b></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></b></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>Public Declare Function OksidCommand Lib
&quot;okdmx31.dll&quot; _</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>(ByVal Command As Integer, ByVal Parameter As Integer,
Buffer As Byte) As Integer</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>Dim OutBuf(511) As Byte</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>Dim InBuf(514) As Byte</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>REM open the interface</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>OksidCommand(1, 0, OutBuf(0))</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>OksidCommand(301, 0, InBuf(0))</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>REM write and read data</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>OksidCommand(4, 512, OutBuf(0))</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>OksidCommand(308, 515, InBuf(0))</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>REM close the interface</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>OksidCommand(2, 0, OutBuf(0))</span></p>

<p class=MsoNormal style='margin-left:35.4pt'><span lang=FR-CH
style='font-family:Arial'>OksidCommand(302, 0, InBuf(0))</span></p>

<p class=MsoNormal><span lang=FR-CH>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=FR-CH style='font-family:Arial'>Contact :</span></b></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<b>O’ksi’D</b> Software </span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Jean-Marc Lienher</span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://www.oksid.ch/">http://www.oksid.ch</a></span></p>

<p class=MsoNormal><span lang=FR-CH style='font-family:Arial'>&nbsp;</span></p>

</div>

</body>

</html>
